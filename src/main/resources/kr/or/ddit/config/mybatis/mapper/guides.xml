<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="guides">

	<!-- 텃밭가이드 코드로 검색 또는 최초 조회 -->
	<select id="selectGuide" resultType="gardenguideVo" parameterType="Integer">
		SELECT * FROM GARDENGUIDE WHERE GUIDE_CODE = #{value}
	</select>

	<!-- 텃밭가이드 코드로 검색 또는 최초 조회 -->
	<select id="selectGuideList" resultType="gardenguideVo" parameterType="guideSqlVo">
		SELECT * FROM GARDENGUIDE WHERE ITEM_CODE >=
		#{sqlwhere1}
		and ITEM_CODE <![CDATA[ < ]]>
		#{sqlwhere2} and USE_YN = 'Y'
	</select>

	<!-- 텃밭가이드 신규 등록 -->

	<insert id="insertGuide" parameterType="gardenguideVo">
		Insert into GARDENGUIDE
		(GUIDE_CODE,WRITER,CLASS_CODE,ITEM_CODE,DIFFICULTY,
		GROW_START_TIME,GROW_TIME,ORIGIN,TEMPERATURE,DAMAGE,
		SEASON,EFFECT,INGREDIENT,PLANT_TIP,PLANT_CONTENT,
		FILE_NO,REG_DT,USE_YN)
		values
		(SEQ_GARDENGUIDE.NEXTVAL,#{writer},#{class_code},#{item_code},#{difficulty},
		#{grow_start_time},#{grow_time},#{origin},#{temperature},#{damage},
		#{season},#{effect},#{ingredient},#{plant_tip},#{plant_content},
		#{file_no},SYSDATE,'Y')
	</insert>

	<!-- 텃밭가이드 수정 -->
	<update id="updateGuide" parameterType="gardenguideVo">
		update GARDENGUIDE
		set
		WRITER =#{writer},CLASS_CODE=#{class_code},ITEM_CODE=#{item_code},DIFFICULTY=#{difficulty},
		GROW_START_TIME =#{grow_start_time},GROW_TIME=#{grow_time},ORIGIN=#{origin},
		TEMPERATURE=#{temperature},DAMAGE=#{damage},
		SEASON=#{season},EFFECT=#{effect},INGREDIENT=#{ingredient},
		PLANT_TIP=#{plant_tip},PLANT_CONTENT=#{plant_content},
		FILE_NO=#{file_no},USE_YN=#{use_yn}
		where GUIDE_CODE = #{guide_code}
	</update>

	<!-- 텃밭가이드 글삭제 수정-user_yn -->
	<update id="deleteGuide" parameterType="gardenguideVo">
		update GARDENGUIDE
		set USE_YN= 'N'
		where GUIDE_CODE = #{guide_code}
	</update>
	
	<!-- ggy_20210315 : code 품목 리스트 조회. itemmanualVo -->
	<select id="itemFarmManualsList" parameterType="String" 
							resultType="codesVo">
		select 
			code_no
			,code_nm
			,parent_code
		from codes
		where parent_code in 
		    (select code_no
		    from codes
		    where parent_code = 
		        (select code_no
		        from codes
		        where parent_code = 'i')
		    and code_no = #{code_no })
		and use_yn = 'Y'
	</select>
	
	<!-- ggy_20210315 : code 품목 분류 리스트 조회. itemmanualVo -->
	<select id="itemClassList" resultType="codesVo">
		select 
			code_no
			,code_nm
			,parent_code
	    from codes
	    where parent_code = 
	        (select code_no
	        from codes
	        where parent_code = 'i')
		and use_yn = 'Y'
	</select>
	

	<!-- 텃밭가이드 전체글 조회-관리자용 -->
	<select id="selectGuideAll" resultType="gardenguideVo">
		SELECT * FROM GARDENGUIDE ORDER BY guide_code DESC
	</select>
	
	
	<!--20210312_KJH 텃밭가이트 이름으로 조회 -->
	<select id="guide_codeselect" resultType="gardenguideVo" parameterType="String">
		select * from gardenguide
        where item_code = #{item_code}
	</select>

</mapper>